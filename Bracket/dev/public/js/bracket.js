// Generated by CoffeeScript 1.2.1-pre
(function() {
  var arrangeGames, bracketHeight, dataLoaded, gameData, overlayData, showOverlay;

  bracketHeight = 0;

  gameData = [];

  overlayData = [];

  showOverlay = function(data) {
    return $('#Overlay').fadeIn();
  };

  dataLoaded = function() {
    return arrangeGames();
  };

  arrangeGames = function() {
    var padding,
      _this = this;
    padding = 54;
    return $('.roundHolder').each(function(i, element) {
      var marginAdjust, numGames;
      $(element).css('left', i * 120);
      numGames = $('.bracketGame', element).length;
      marginAdjust = (padding * (16 / numGames)) + padding + (padding / 2 * ((16 / numGames) - 1));
      return $('.bracketGame', element).each(function(i, element) {
        var topPos;
        topPos = (i * (padding * (16 / numGames)) + padding + (padding / 2 * ((16 / numGames) - 1))) - 10;
        bracketHeight = Math.max(bracketHeight, topPos);
        $(element).css('top', topPos);
        return $(element).click(function() {
          var game, gameID, round, roundData, _results;
          gameID = $(element).attr('data-id');
          _results = [];
          for (round in gameData) {
            roundData = gameData[round].game;
            _results.push((function() {
              var _results2;
              _results2 = [];
              for (game in roundData) {
                if (roundData[game].id === gameID) overlayData = roundData[game];
                _results2.push(showOverlay(overlayData));
              }
              return _results2;
            })());
          }
          return _results;
        });
      });
    });
  };

  $(document).ready(function() {
    $.getJSON("data/bracket.json", function(data) {
      gameData = data.bracket.round;
      $("#Main").append(Mustache.to_html($("#spread-template").html(), {
        bracketData: data
      }));
      dataLoaded();
      return $.getJSON("data/teams.json", function(data) {
        $("#Main").append(Mustache.to_html($("#teams-template").html(), {
          teamData: data
        }));
        $('#teamSheet').css('top', bracketHeight + 120);
        return $(".leagueTeam").each(function(i, element) {
          if ($(element).attr("data-active") === 'false') {
            return $(element).css("text-decoration", "line-through");
          }
        });
      });
    });
    return $('#Overlay-close').click(function() {
      return $('#Overlay').fadeOut();
    });
  });

}).call(this);
